SELECT starttime FROM cd.bookings JOIN cd.members ON bookings.memid = cd.members.memid WHERE cd.members.firstname = 'David' AND cd.members.surname = 'Farrell';
SELECT cd.bookings.starttime AS start, cd.facilities.name FROM cd.bookings JOIN cd.facilities ON cd.bookings.facid = cd.facilities.facid WHERE name LIKE 'Tennis%' AND cd.bookings.starttime BETWEEN '2012-09-21 00:00:00' AND '2012-09-22 00:00:00' ORDER BY start;
SELECT DISTINCT recs.firstname, recs.surname FROM cd.members mems JOIN cd.members recs ON recs.memid = mems.recommendedby ORDER BY surname, firstname;
SELECT mems.firstname AS memfname, mems.surname AS memsname, recs.firstname AS recfname, recs.surname AS recsname FROM cd.members mems LEFT OUTER JOIN cd.members recs ON recs.memid = mems.recommendedby ORDER BY memsname, memfname;
SELECT DISTINCT CONCAT(cd.members.firstname, ' ', cd.members.surname) AS member, cd.facilities.name AS facility FROM cd.bookings JOIN cd.members ON cd.members.memid = cd.bookings.MEMID JOIN cd.facilities ON cd.bookings.facid = cd.facilities.facid WHERE cd.facilities.name LIKE 'Tennis%'  ORDER BY member, facility;
SELECT CONCAT(cd.members.firstname, ' ', cd.members.surname) AS member, cd.facilities.name AS facility, CASE WHEN cd.members.memid = 0 THEN cd.bookings.slots*cd.facilities.guestcost ELSE cd.bookings.slots*cd.facilities.membercost END AS cost FROM cd.bookings JOIN cd.members ON cd.members.memid = cd.bookings.memid JOIN cd.facilities ON cd.bookings.facid = cd.facilities.facid WHERE cd.bookings.starttime BETWEEN '2012-09-14 00:00:00' AND '2012-09-15 00:00:00' AND ((cd.members.memid = 0 and cd.bookings.slots*cd.facilities.guestcost > 30) OR (cd.members.memid != 0 and cd.bookings.slots*cd.facilities.membercost > 30))ORDER BY cost DESC;
